{
    "keyring": {
        "bitcoin": "L532fW63yrm6Jgd36NXYFDEz5HsmgTz67mGYsKkCtt26rAg7qg8y",
        "credential": "hd74Aegfq8nRDWCqs5vOA0lHOzHQzjzIByBLtgwfLYU=",
        "ecdh": "oTiBxSDE71k5PFaXTxnTb9zsTTdZ701XMWKbdnhN5Jg=",
        "eddsa": "ErCHR7PMWiCHNZnRwK2oAHLnrydMCKVzP84JZS8ZAuGd",
        "es256": "i3XWJbqjkLvST16BSvNO1owZG56RcU590Kp/SvWgHy4=",
        "ethereum": "bbcf12b582ec688474e765e63b45040981e1cebb657c17d2925298dfe6f75d40",
        "reflow": "hd74Aegfq8nRDWCqs5vOA0lHOzHQzjzIByBLtgwfLYU="
    },
    "client_id": "did:dyne:sandbox.signroom:PTDvvQn1iWQiVxkfsDnUid8FbieKbHq46Qs8c9CZx67",
    "oauth_flow_parameters": {
        "space": " ",
        "jwt-body-params": {
            "state": "xyz"
        }
    },
    "token_headers": {
        "Content-Type": "application/x-www-form-urlencoded"
    },
    "nonce_headers": {
        "Content-Length": "0"
    },
    "data": {},
    "keys": {},
    "client_id_path": "client_id",
    "keyring_path": "keyring",
    "oauth_flow_parameters_path": "oauth_flow_parameters",
    "code_path": "code",
    "code_verifier_path": "code_verifier",
    "credential_parameters_path": "credential_parameters",
    "credential_endpoint_path": "credential_endpoint",
    "token_endpoint_path": "token_endpoint",
    "r.access_token": "result.access_token",
    "r.token_type": "result.token_type",
    "r.c_nonce": "result.c_nonce",
    "access_token_path": "access_token",
    "token_type_path": "token_type",
    "c_nonce_path": "c_nonce",
    "nonce_endpoint_path": "nonce_endpoint",
    "data_path": "data",
    "headers_path": "headers",
    "redirect_uri_path": "redirect_uri",
    "dpop_path": "DPoP",
    "zen_pre_token": "scenario 'w3c': DPoP\nScenario 'http': application/x-www-form-urlencoded\n# keys\nGiven I have a 'keyring'\nGiven I have a 'string' named 'client_id'\nGiven I have a 'string dictionary' named 'jwt-body-params' inside 'oauth_flow_parameters'\n# data\nGiven I have a 'string' named 'grant_type' inside 'credential_parameters'\nGiven I have a 'string' named 'token_endpoint' inside 'credential_parameters'\nGiven I have a 'string' named 'code_verifier'\nGiven I have a 'string' named 'code'\nGiven I have a 'string' named 'redirect_uri'\nWhen I create jwk of es256 public key\nWhen I create the random 'ramdom_jti'\nWhen I write the string '' in 'jti'\nWhen I append the 'url64' of 'ramdom_jti' to 'jti'\nWhen I copy 'token_endpoint' to 'token_endpoint_copy'\nWhen I rename the 'token_endpoint_copy' to 'htu'\nWhen I create the timestamp\nWhen I rename the 'timestamp' to 'iat'\nWhen I set 'htm' to 'POST' as 'string'\nWhen I set 'alg' to 'ES256' as 'string'\nWhen I set 'typ' to 'dpop+jwt' as 'string'\nWhen I create the 'string dictionary' named 'DPoP-payload'\nWhen I move 'iat' in 'DPoP-payload'\nWhen I move 'jti' in 'DPoP-payload'\nWhen I move 'htu' in 'DPoP-payload'\nWhen I move 'htm' in 'DPoP-payload'\nWhen I create the 'string dictionary' named 'DPoP-header'\nWhen I move 'alg' in 'DPoP-header'\nWhen I move 'typ' in 'DPoP-header'\nWhen I move 'jwk' in 'DPoP-header'\nWhen I create the jws signature of header 'DPoP-header' and payload 'DPoP-payload'\nWhen I rename the 'jws signature' to 'DPoP'\nWhen I create the 'string dictionary' named 'data'\nand I move 'client_id' in 'data'\nand I move 'code' in 'data'\nand I move 'redirect_uri' in 'data'\nand I move 'code_verifier' in 'data'\nand I move 'grant_type' in 'data'\nWhen I create http get parameters from 'data' using percent encoding\nand I remove 'data'\nand I rename the 'http_get_parameters' to 'data'\nThen print the 'DPoP'\nThen print the 'data'\nThen print the 'token_endpoint'",
    "zen_pre_credential": "scenario 'w3c': DPoP\n# keys\nGiven I have a 'keyring'\nGiven I have a 'string' named 'client_id'\nGiven I have a 'string' named 'space' inside 'oauth_flow_parameters'\n# data\nGiven I have a 'string' named 'format' inside 'credential_parameters'\nGiven I have a 'string' named 'credential_configuration_id' inside 'credential_parameters'\nGiven I have a 'string' named 'credential_endpoint' inside 'credential_parameters'\nGiven I have a 'string' named 'credential_issuer' inside 'credential_parameters'\nGiven I have a 'string' named 'access_token'\nGiven I have a 'string' named 'token_type'\nGiven I have a 'string' named 'c_nonce'\nWhen I create jwk of es256 public key\nWhen I copy 'credential_issuer' to 'aud'\n## 1. Create proof-payload\nWhen I create the 'string dictionary' named 'proof-payload'\nWhen I create the timestamp\nWhen I rename the 'timestamp' to 'iat'\nWhen I move 'iat' in 'proof-payload'\nWhen I rename the 'client_id' to 'iss'\nWhen I move 'iss' in 'proof-payload'\nWhen I move 'aud' in 'proof-payload'\nWhen I rename the 'c_nonce' to 'nonce'\nWhen I move 'nonce' in 'proof-payload'\n## end 1.\n## 2. create proof-header\nWhen I create the 'string dictionary' named 'proof-header'\nWhen I set 'alg' to 'ES256' as 'string'\nWhen I set 'typ' to 'open4vci-proof+jwt' as 'string'\nWhen I move 'alg' in 'proof-header'\nWhen I move 'typ' in 'proof-header'\nWhen I move 'jwk' in 'proof-header'\n## end 2,\n# 3. create jws from proof-header and proof-payload and create proof\nWhen I create the 'string dictionary' named 'proof'\nWhen I create the jws signature of header 'proof-header' and payload 'proof-payload'\nWhen I rename the 'jws signature' to 'jwt'\nWhen I move 'jwt' in 'proof'\nWhen I set 'proof_type' to 'jwt' as 'string'\nWhen I move 'proof_type' in 'proof'\n## end 3.\nWhen I create the 'string dictionary' named 'headers'\nWhen I set 'DPoP_string' to 'DPoP' as 'string'\n# RFC 9449\nIf I verify 'token_type' is equal to 'DPoP_string'\nWhen I create the 'string dictionary' named 'jws_header'\nWhen I set 'typ' to 'dpop+jwt' as 'string'\nWhen I move 'typ' in 'jws_header'\nWhen I set 'alg' to 'ES256' as 'string'\nWhen I move 'alg' in 'jws_header'\nWhen I create jwk of p256 public key\nWhen I move 'jwk' in 'jws_header'\nWhen I create the 'string dictionary' named 'body'\nWhen I set 'htm' to 'POST' as 'string'\nWhen I move 'htm' in 'body'\nWhen I copy 'credential_endpoint' to 'htu' in 'body'\nWhen I create the timestamp\nWhen I move 'timestamp' to 'iat' in 'body'\nWhen I create the hash of 'access_token'\nWhen I write string '' in 'ath'\nWhen I append the 'url64' of 'hash' to 'ath'\nWhen I move 'ath' in 'body'\nWhen I create random of '96' bits\nWhen I write string '' in 'jti'\nWhen I append the 'url64' of 'random' to 'jti'\nWhen I move 'jti' in 'body'\nWhen I create the jws signature of header 'jws_header' and payload 'body'\nWhen I move 'jws signature' to 'DPoP' in 'headers'\nEndIf\nWhen I rename 'token_type' to 'Authorization'\nand I append 'space' to 'Authorization'\nand I append 'access_token' to 'Authorization'\nand I move 'Authorization' in 'headers'\nWhen I create the 'string dictionary' named 'data'\nand I move 'proof' in 'data'\nand I move 'credential_configuration_id' in 'data'\nand I move 'format' in 'data'\nThen print the 'data'\nThen print the 'credential_endpoint'\nThen print the 'headers'"
}