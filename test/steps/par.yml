name: Call par endpoint
http:
  url: http://${{env.mz_host}}/call_par
  method: POST
  json:
    credential_parameters:
      authorization_endpoint: ${{captures.credential_parameters.authorization_endpoint}}
      authorization_server_endpoint_par: ${{captures.credential_parameters.authorization_server_endpoint_par}}
      code_challenge_method: ${{captures.credential_parameters.code_challenge_method}}
      credential_endpoint: ${{captures.credential_parameters.credential_endpoint}}
      credential_issuer: ${{captures.credential_parameters.credential_issuer}}
      format: ${{captures.credential_parameters.format}}
      grant_type: ${{captures.credential_parameters.grant_type}}
      response_type: ${{captures.credential_parameters.response_type}}
      token_endpoint: ${{captures.credential_parameters.token_endpoint}}
      credential_configuration_id: ${{captures.credential_parameters.credential_configuration_id}}
    redirect_uri: openid-credential-issuer://example.com/
  captures:
    code_verifier:
      jsonpath: $.code_verifier
    request_uri:
      jsonpath: $.request_uri
    client_id:
      jsonpath: $.client_id
    authorization_endpoint:
      jsonpath: $.authorization_endpoint
  check:
    status: 200
    jsonpath:
      $.code_verifier:
        - isDefined: true
      $.request_uri:
        - isDefined: true
      $.client_id:
        - isDefined: true
      $.authorization_endpoint:
        - eq: http://${{env.as_host}}/authorize
      $.expires_in:
        - eq: 600