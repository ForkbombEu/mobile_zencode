name: send vp to rp
http:
  url: http://${{env.mz_host}}/openid4vp_response
  method: POST
  json:
    body:
      vp_token:
        test_presentation_ldp_vc:
        - "@context":
          - ${{ captures.vps.test_presentation_ldp_vc.0.signed.@context.0 }}
          - ${{ captures.vps.test_presentation_ldp_vc.0.signed.@context.1 }}
          holder: ${{ captures.vps.test_presentation_ldp_vc.0.signed.holder }}
          id: ${{ captures.vps.test_presentation_ldp_vc.0.signed.id }}
          proof:
            challenge: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.challenge }}
            created: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.created }}
            cryptosuite: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.cryptosuite }}
            domain: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.domain }}
            proofPurpose: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.proofPurpose }}
            proofValue: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.proofValue }}
            type: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.type }}
            verificationMethod: ${{ captures.vps.test_presentation_ldp_vc.0.signed.proof.verificationMethod }}
          type:
          - ${{ captures.vps.test_presentation_ldp_vc.0.signed.type.0 }}
          verifiableCredential:
          - "@context":
            - ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.@context.0 }}
            - ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.@context.1 }}
            credentialSubject:
              degree: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.credentialSubject.degree }}
              family_name: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.credentialSubject.family_name }}
              given_name: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.credentialSubject.given_name }}
            issuer: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.issuer }}
            proof:
              created: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.proof.created }}
              cryptosuite: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.proof.cryptosuite }}
              proofPurpose: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.proof.proofPurpose }}
              proofValue: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.proof.proofValue }}
              type: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.proof.type }}
              verificationMethod: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.proof.verificationMethod }}
            type:
            - ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.type.0 }}
            - ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.type.1 }}
            validUntil: ${{ captures.vps.test_presentation_ldp_vc.0.signed.verifiableCredential.0.validUntil }}
    url: ${{captures.post_url}}
  check:
    status: 200
    jsonpath:
      $.result.status:
        - eq: "200"